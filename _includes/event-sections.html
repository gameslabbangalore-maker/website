{%- comment -%}
  _includes/event-sections.html
  Renders:
  1) Structured copy (About / What makes it different / How it works / Why join? / Closing)
     pulled from the matching collection item (by slug) — shown at the TOP.
  2) Optional "About the event" video (opens in modal).
  3) Optional Event recaps grid (opens in modal).

  Notes:
  - Uses a wrapper .structured-sections so desktop stays single-column here only.
  - Uses a data-URI placeholder as a guaranteed thumbnail to avoid visible link text if a thumb is missing.
{%- endcomment -%}

{%- assign ev = site.events | where: "slug", page.slug | first -%}

{%- comment -%} 1) Structured sections — TOP {%- endcomment -%}
<div class="structured-sections">
{% if ev %}

  {% if ev.about %}
  <section class="section">
    <h2>About Night of Mafias</h2>
    <div class="prose">{{ ev.about | markdownify }}</div>
  </section>
  {% endif %}

  {% if ev.what_makes_it_different %}
  <section class="section">
    <h2>What makes it different</h2>
    <div class="prose">{{ ev.what_makes_it_different | markdownify }}</div>
  </section>
  {% endif %}

  {% if ev.how_it_works %}
  <section class="section">
    <h2>How it works</h2>
    <div class="prose">{{ ev.how_it_works | markdownify }}</div>
  </section>
  {% endif %}

  {% if ev.why_join %}
  <section class="section">
    <h2>Why join?</h2>
    <div class="prose">{{ ev.why_join | markdownify }}</div>
  </section>
  {% endif %}

  {% if ev.closing %}
  <section class="section">
    <div class="prose">{{ ev.closing | markdownify }}</div>
  </section>
  {% endif %}

{% endif %}
</div>

{%- comment -%}
  Helper: safe 1x1 placeholder (prevents anchor rendering as blue text when thumb is missing).
{%- endcomment -%}
{% assign placeholder_thumb = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==" %}

{%- comment -%} 2) Optional "About the event" video (guarded) {%- endcomment -%}
{% if page.about_video %}
  {%- assign about_url = page.about_video -%}
  {%- if page.about_video.url -%}{% assign about_url = page.about_video.url %}{%- endif -%}
  {%- assign about_thumb = page.about_video_thumb | default: page.about_video.thumb | default: placeholder_thumb -%}

  <section class="section" id="about-event">
    <h2>About the event</h2>
    <div class="video-wrap">
      <a class="video-landscape" data-embed href="{{ about_url | escape }}">
        <img src="{{ about_thumb | escape }}" alt="About video" loading="lazy">
        <span class="play">▶</span>
      </a>
    </div>
  </section>
{% endif %}

{%- comment -%} 3) Optional Event Recaps grid (guarded) {%- endcomment -%}
{% if page.recap_videos and page.recap_videos.size > 0 %}
  <section class="section" id="event-recaps">
    <h2>Event recaps</h2>
    <div class="recaps-grid">
      {% for v in page.recap_videos %}
        {%- assign v_url = v -%}
        {%- assign v_title = "Recap video" -%}
        {%- assign v_thumb = placeholder_thumb -%}

        {%- if v.url -%}{% assign v_url = v.url %}{%- endif -%}
        {%- if v.title -%}{% assign v_title = v.title %}{%- endif -%}
        {%- if v.thumb -%}{% assign v_thumb = v.thumb %}{%- endif -%}

        <a class="video-portrait" data-embed href="{{ v_url | escape }}">
          <img src="{{ v_thumb | escape }}" alt="{{ v_title | escape }}" loading="lazy">
          <span class="play">▶</span>
        </a>
      {% endfor %}
    </div>
  </section>
{% endif %}
