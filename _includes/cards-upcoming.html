{% assign upcoming = site.data.event_schedule.upcoming | default: empty %}
<div class="title"><h2>Upcoming Events</h2></div>
<div class="cards-row" aria-live="polite">
  {% if upcoming.size > 0 %}
    {% for item in upcoming %}
      <article class="card" data-url="{{ item.page_url | default: '#' }}">
        <div class="media">
          {% assign banner = item.banner | default: 'https://via.placeholder.com/800x450?text=Event+Image' %}
          <img
            src="{{ banner }}"
            alt="{{ item.title | default: 'Event image' }}"
            loading="lazy"
            width="800"
            height="450"
            onerror="if(!this.dataset.fallback){this.dataset.fallback='1';this.src='https://via.placeholder.com/800x450?text=Event+Image';}"
          >
        </div>
        <div class="card-body">
          <h3 class="event-title">{{ item.title }}</h3>
          <p class="meta">
            {{ item.display_date }}{% if item.display_time and item.display_time != '' %} | {{ item.display_time }}{% endif %}
          </p>
          {% if item.location.name or item.location.raw %}
            <p class="location">{{ item.location.name | default: item.location.raw }}</p>
          {% endif %}
          <p class="mobile-info">
            {% if item.location.name or item.location.raw %}
              {{ item.location.name | default: item.location.raw }}
            {% endif %}
            {% if (item.location.name or item.location.raw) and item.display_time and item.display_time != '' %}
              | {{ item.display_time }}
            {% elsif item.display_time and item.display_time != '' %}
              {{ item.display_time }}
            {% endif %}
          </p>
        </div>
        <div class="card-date">
          <div class="day">{{ item.start | date: "%d" }}</div>
          <div class="month">{{ item.start | date: "%b" }}</div>
          <div class="time"></div>
        </div>
        <div class="card-footer">
          {% if item.page_url %}
            <a class="book-btn" href="{{ item.page_url }}">Details</a>
          {% endif %}
        </div>
      </article>
    {% endfor %}
  {% else %}
    <p style="color:#bbb">No upcoming events.</p>
  {% endif %}
</div>
<script>
(function(){
  document.querySelectorAll('.card[data-url]').forEach(function(card){
    card.addEventListener('click', function(evt){
      if (evt.target.closest('a,button')) return;
      if (window.innerWidth <= 768){
        var url = card.getAttribute('data-url');
        if (url) window.location.href = url;
      }
    });
  });
})();
</script>
